<!DOCTYPE html>
<html lang="he"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>אוף, עדכונים… | Learn Linux</title>
<meta name="generator" content="Jekyll v3.9.5" />
<meta property="og:title" content="אוף, עדכונים…" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="כיצד לשמור על המערכת שלנו מעודכנת הדבר החשוב בניהול מערכות ממוחשבות הוא תחזוקה. בין שלל משימות התחזוקה נמצאת גם משימת עדכון התוכנה. בפוסט זה אכתוב כיצד להקל במשימה זו, שאיך לומר בעדינות, להרבה אין סבלנות אליה." />
<meta property="og:description" content="כיצד לשמור על המערכת שלנו מעודכנת הדבר החשוב בניהול מערכות ממוחשבות הוא תחזוקה. בין שלל משימות התחזוקה נמצאת גם משימת עדכון התוכנה. בפוסט זה אכתוב כיצד להקל במשימה זו, שאיך לומר בעדינות, להרבה אין סבלנות אליה." />
<link rel="canonical" href="http://localhost:4000/2024/07/09/%D7%90%D7%95%D7%A3-%D7%A2%D7%93%D7%9B%D7%95%D7%A0%D7%99%D7%9D.html" />
<meta property="og:url" content="http://localhost:4000/2024/07/09/%D7%90%D7%95%D7%A3-%D7%A2%D7%93%D7%9B%D7%95%D7%A0%D7%99%D7%9D.html" />
<meta property="og:site_name" content="Learn Linux" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-07-09T00:00:00+03:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="אוף, עדכונים…" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-07-09T00:00:00+03:00","datePublished":"2024-07-09T00:00:00+03:00","description":"כיצד לשמור על המערכת שלנו מעודכנת הדבר החשוב בניהול מערכות ממוחשבות הוא תחזוקה. בין שלל משימות התחזוקה נמצאת גם משימת עדכון התוכנה. בפוסט זה אכתוב כיצד להקל במשימה זו, שאיך לומר בעדינות, להרבה אין סבלנות אליה.","headline":"אוף, עדכונים…","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2024/07/09/%D7%90%D7%95%D7%A3-%D7%A2%D7%93%D7%9B%D7%95%D7%A0%D7%99%D7%9D.html"},"url":"http://localhost:4000/2024/07/09/%D7%90%D7%95%D7%A3-%D7%A2%D7%93%D7%9B%D7%95%D7%A0%D7%99%D7%9D.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Learn Linux" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Learn Linux</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">אוף, עדכונים...</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2024-07-09T00:00:00+03:00" itemprop="datePublished">Jul 9, 2024
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h1 id="כיצד-לשמור-על-המערכת-שלנו-מעודכנת">כיצד לשמור על המערכת שלנו מעודכנת</h1>
<p>הדבר החשוב בניהול מערכות ממוחשבות הוא תחזוקה. בין שלל משימות התחזוקה נמצאת גם משימת עדכון התוכנה. בפוסט זה אכתוב כיצד להקל במשימה זו, שאיך לומר בעדינות, להרבה אין סבלנות אליה.</p>

<p>בפוסט אשתף בדרך שאני פועל על מנת לבצע עדכונים שוטפים בכל יום. אני משתמש בשני כלים: סקריפט, ומשימה מתוזמנת שמריצה את הסקריפט לבדיקת עדכונים. ולאחר מכן עדכון החבילות בפועל באופן ידני.</p>

<h2 id="כתיבת-סקריפט">כתיבת סקריפט</h2>
<p>כצעד ראשון נכתוב סקריפט פשוט שמטרתו לבצע את בדיקת עדכונים ולכתוב אותם לקובץ עם חתימת תאריך בשמו.</p>

<p><em>להלן הסקריפט למערכות פדורה:</em></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>

dnf check-update <span class="o">&gt;</span> /home/nachmen/Desktop/dnf-update-logs/<span class="s2">"</span><span class="si">$(</span><span class="nb">date</span> +<span class="s1">'%d-%m-%y'</span><span class="si">)</span><span class="s2">"</span>
</code></pre></div></div>

<p>אפרק לגורמים את הפקודה:</p>

<ol>
  <li>הפקודה הראשונה היא בדיקת העדכונים, <code class="language-plaintext highlighter-rouge">dnf check-update</code> .</li>
  <li>פלט הפקודה ייכתב לקובץ חדש במיקום <code class="language-plaintext highlighter-rouge">/home/nachmen/Desktop/dnf-update-logs/</code> .</li>
  <li>שם הקובץ יקבל את תאריך הביצוע, שהוא ביטוי של המשתנה <code class="language-plaintext highlighter-rouge">"$(date +'%d-%m-%y')"</code> .</li>
</ol>

<p>ניתן לסקריפט הרשאות ריצה:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">chmod</span> +x dnf_updates.sh
</code></pre></div></div>

<p>ונשמור אותו במקום <strong>קבוע</strong> במחשב. אני למשל שומר את כל הסקריפטים שלי בתיקיית <code class="language-plaintext highlighter-rouge">Scripts</code> בתיקיית הבית שלי. הסיבה שמיקום הסקריפט חייב להיות קבוע משום שבצעד הבא בתהליך - קביעת משימה מתוזמנת - נצטרך לתת מיקום של הסקריפט לביצוע.</p>

<h2 id="כתיבת-משימה-מתוזמנת">כתיבת משימה מתוזמנת</h2>
<p>כעת ניצור משימה מתוזמנת שתרוץ בכל יום בשעה קבועה. <strong>שימו לב</strong>: אם מדובר במחשב אישי אז סביר להניח שישנם שעות שהמחשב כבוי, או לחילופין אינו מחובר לאינטרנט. אין טעם להריץ משימה בזמן כזה. על כן יש לבחור שעה ביום שבדרך כלל המחשב פועל והוא גם מחובר לאינטרנט.</p>

<p>היות והפקודה <code class="language-plaintext highlighter-rouge">dnf check-update</code> איננה דורשת הרשאות גבוהות, ניתן להריץ אותה גם כמשתמש רגיל, ולכן גם התהליך שיפעיל את הפקודה אינו צריך להיות עם הרשאות גבוהות.</p>

<p>נקליד בטרמינל את הפקודה הבאה:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>crontab <span class="nt">-e</span>
</code></pre></div></div>

<p>תוכנת <code class="language-plaintext highlighter-rouge">crontab</code> מנהלת את המשימות המתזמנות של המערכת, והפרמטר <code class="language-plaintext highlighter-rouge">e-</code> מציין edit - עריכת המשימות.</p>

<p>יפתח בפנינו עורך הטקסט <code class="language-plaintext highlighter-rouge">nano</code> , ואם זו הפעם הראשונה שבה אנו יוצרים משימה מתוזמנת - הקובץ יהיה ריק.</p>

<p>נחליט שאנו רוצים להריץ בדיקת עדכונים בכל יום בשעה 11:45 לפני הצהריים, נוסיף שורה זו בקובץ:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>45 11 <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> /home/nachmen/Scripts/dnf-updates.sh
</code></pre></div></div>

<p>להסביר את הצופן הזה, נקרא את הקובץ <code class="language-plaintext highlighter-rouge">etc/crontab/</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># For details see man 4 crontabs

# Example of job definition:
# .---------------- minute (0 - 59)
# |  .------------- hour (0 - 23)
# |  |  .---------- day of month (1 - 31)
# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...
# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat
# |  |  |  |  |
# *  *  *  *  * user-name  command to be executed
</code></pre></div></div>

<p>למעשה קובץ זה מסביר את מבנה והתחביר של השורה בקובץ <code class="language-plaintext highlighter-rouge">crontab</code> , ובעצם הפקודה מחולקת לשלושה חלקים: זמן הביצוע, המשתמש שיבצע, והפקודה שתבוצע.</p>

<p><strong>הביטוי של זמן הביצוע הוא באופן הבא:</strong></p>

<ul>
  <li>הכוכבית הראשונה משמאל מציינת את הדקה בשעה - בין 0 ל- 59.</li>
  <li>הכוכבית השנייה מציינת את השעה ביום - בין 0 ל- 23.</li>
  <li>הכוכבית השלישית מציינת יום <strong>בחודש</strong> - בין 1 ל- 31.</li>
  <li>הכוכבית הרביעית מציינת את החודש בשנה - בין 1 ל- 12.</li>
  <li>הכוכבית החמישית מציינת את היום <strong>בשבוע</strong> - בין 0 ל- 6 כאשר 0 הוא יום ראשון, או כתיבת שם היום.</li>
</ul>

<p>במקרה שלנו, אנו כתבנו בכוכבית השנייה 11, ובכוכבית הראשונה 45. המשמעות: בשעה 11, ודקה 45. ומכיוון שלא ציינו את היום בחודש, החודש, והיום בשבוע - המשימה תרוץ בכל יום ויום.</p>

<p>כדי לסמלץ את הנושא ניתן להיעזר באתר <a href="https://crontab.guru/">crontab.guru</a> בו ניתן “לקבוע זמן” לביצוע המשימה, ולקבל פידבק מתי זה יקרה. הנה תמונה של האתר:</p>

<p><img src="/assets/Crontab.guru.png" alt="Crontab.guru" /></p>

<p>בשורה באמצע כותבים את התאריך והשעה, ומיד מופיע מתי תהיה הפעם הבאה שהמשימה תרוץ.</p>

<p>כעת, נכתוב את הנתיב והמיקום המדויק של הסקריפט שבודק עדכונים,  במקרה שלנו הוא <code class="language-plaintext highlighter-rouge">/home/nachmen/Scripts/dnf-updates.sh</code> , ונשמור את הקובץ (ctrl + o, enter) ונצא מעורך הטקסט (ctrl + x).</p>

<p>במקרה שלנו אין חובה לציין את המשתמש שיריץ את המשימה.</p>

<p>לוודא שהמשימה אכן נכתבה ונשמרה נקליד את הפקודה:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>crontab <span class="nt">-l</span>
</code></pre></div></div>

<p>כאשר הפרמטר <code class="language-plaintext highlighter-rouge">l-</code> מציין את רשימת המשימות. במקרה שלנו היות וזו היא המשימה הראשונה שכתבנו - תופיע שורה יחידה:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>45 11 <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> /home/nachmen/Scripts/dnf-update.sh
</code></pre></div></div>

<p>כעת מה שנשאר זה כל יום לקרוא את רשימת העדכונים אשר נכתבו בקובץ העדכונים היומי, ולהריץ את הפקודה:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>dnf upgrade
</code></pre></div></div>

<h1 id="בהצלחה">בהצלחה!</h1>

  </div><a class="u-url" href="/2024/07/09/%D7%90%D7%95%D7%A3-%D7%A2%D7%93%D7%9B%D7%95%D7%A0%D7%99%D7%9D.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Learn Linux</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Learn Linux</li><li><a class="u-email" href="mailto:nachmenkurtz@gmail.com">nachmenkurtz@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>ללמוד לינוקס, האתגרים של מתחיל בלינוקס, ומאמרים לתחילים בלינוקס, הכל מכל כל נמצא כאן.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
